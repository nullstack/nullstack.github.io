<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="Created with Nullstack - https://nullstack.app" />
    <title>Context Service Worker - Nullstack</title>
    <meta property="og:image" content="https://nullstack.app/image-1200x630.png">
    <meta property="og:description" content="The worker object is a proxy in the Nullstack Context available in both client and server and gives you granular control of your PWA behavior">
    <meta name="description" content="The worker object is a proxy in the Nullstack Context available in both client and server and gives you granular control of your PWA behavior">
    <meta property="og:title" content="Context Service Worker - Nullstack">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Nullstack">
    <meta property="og:url" content="https://nullstack.app/service-worker">
    <link rel="canonical" href="https://nullstack.app/service-worker">
    
    <link rel="shortcut icon" href="/favicon-96x96.png" type="image/png">
    <link rel="icon" href="/favicon-96x96.png" type="image/png">
    <link rel="manifest" href="/manifest-18812b1cb40cd21fad1f9d310e5064f10dac9d64.json" integrity="sha512-dZgijzedfi73kz1kWm59C1cCtmMc4h1r1cC/8LGrn8niVN5QOpk6VM3id275XMzw8LrPIohK8bk3c6V070nTMQ==">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Nullstack">
    <meta name="apple-mobile-web-app-title" content="Nullstack">
    
    <meta name="msapplication-starturl" content="/">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="/client-18812b1cb40cd21fad1f9d310e5064f10dac9d64.css" integrity="sha512-nkr7s9QD6hys3pVhwjEMGAXUgWtuUTvt2FMTETCHUtdKRJIIxb3UcBXgH40GkupEXAMPWBDP4SJxXekTurgsSw==" crossorigin="anonymous">
    
    <link rel="apple-touch-icon" sizes="180x180" href="/icon-180x180.png">
    <meta name="msapplication-TileColor" content="#2d3748">
    <link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="preload" href="/roboto-v20-latin-300.woff2" as="font" type="font/woff2" crossorigin/><link rel="preload" href="/roboto-v20-latin-500.woff2" as="font" type="font/woff2" crossorigin/><link rel="preload" href="/crete-round-v9-latin-regular.woff2" as="font" type="font/woff2" crossorigin/>
  </head>
  <body>
    <div id="application"><main class="light"><div class="dark:bg-gray-900 dark:text-white"><header class="fixed w-full bg-white dark:bg-gray-900 shadow top-0 left-0 z-20"><div class="max-w-screen-xl mx-auto px-4 flex justify-between items-center flex-wrap py-4"><div class="w-full sm:w-auto justify-between sm:justify-self-start sm:px-0 items-center flex"><a title="Nullstack" href="/"><svg xmlns="http://www.w3.org/2000/svg" height="30" viewBox="0 0 511.5039 113.7368"><title> Nullstack <!--#--></title><path d="M13.2736,39.964H28.7009v9.8922a20.3919,20.3919,0,0,1,7.743-8.479,21.2792,21.2792,0,0,1,11.2172-3.0031q7.36,0,11.3349,4.1218t3.9745,11.6588a48.9655,48.9655,0,0,1-1.06,8.8913l-8.3025,42.8665H36.3556L44.187,65.7546a31.2306,31.2306,0,0,0,.5888-5.5939q0-7.6542-6.3593-7.6547a10.7348,10.7348,0,0,0-8.4791,4.3278q-3.5922,4.328-5.0639,12.0415l-7.1248,37.0372H.4961Z" transform="translate(-0.4961)" fill="#2d3748"></path><path d="M81.4691,107.62q-7.2426,0-11.2466-4.1807t-4.004-11.8943a46.3965,46.3965,0,0,1,1.001-8.6557L75.64,39.964H92.7746L85.0609,80.24a29.8175,29.8175,0,0,0-.5888,5.5938q0,7.6551,6.4771,7.6548A10.3547,10.3547,0,0,0,99.2811,89.19q3.4446-4.2978,4.9756-12.0709L111.44,39.964h17.1348l-12.7775,65.9485H100.37V96.138a18.7565,18.7565,0,0,1-7.4781,8.3908A21.4849,21.4849,0,0,1,81.4691,107.62Z" transform="translate(-0.4961)" fill="#2d3748"></path><path d="M150.2958,113.7368q-11.4821,0-16.7815-3.3563t-5.2995-10.5989a43.049,43.049,0,0,1,1.1188-8.3613l11.9532-56.6451H123.2687l2.532-13.2486h35.2118L146.2918,92.4213q-.1767.825-.3238,1.7371a10.5763,10.5763,0,0,0-.1473,1.6781q0,4.6521,8.2436,4.6517h16.3694l-2.65,13.2486Z" transform="translate(-0.4961)" fill="#d22365"></path><path d="M181.897,92.21q-11.4822,0-16.7816-3.3563T159.816,78.255a43.0455,43.0455,0,0,1,1.1187-8.3613l11.9532-56.6451H154.87L157.4018,0h35.2118L177.8929,70.8947q-.1765.8248-.3238,1.737a10.5766,10.5766,0,0,0-.1472,1.6782q0,4.6519,8.2435,4.6517h16.3694l-2.65,13.2486Z" transform="translate(-0.4961)" fill="#d22365"></path><path d="M228.3106,107.62a72.47,72.47,0,0,1-23.6119-4.1218l3.003-15.0739q10.5988,6.7717,21.6688,6.7715,6.4176,0,10.0983-2.2965a7.1387,7.1387,0,0,0,3.68-6.3593,4.4873,4.4873,0,0,0-1.8253-3.8273q-2.3556-1.884-9.5979-3.9452l-5.1817-1.4132q-13.8969-3.8271-13.8963-16.9582a18.9819,18.9819,0,0,1,8.0375-16.0455q8.0374-5.976,22.4637-5.9766a60.6829,60.6829,0,0,1,10.1573.8538,63.0434,63.0434,0,0,1,10.5105,2.797L260.8727,56.981a33.7,33.7,0,0,0-19.3724-6.3q-5.9478,0-9.3623,2.09a6.2659,6.2659,0,0,0-3.4152,5.5056,5.102,5.102,0,0,0,2.2375,4.2984q2.4731,1.7082,9.6568,3.7685l4.3573,1.2365q7.4775,2.12,10.9816,6.271t3.5035,10.805q0,10.7172-8.2436,16.84T228.3106,107.62Z" transform="translate(-0.4961)" fill="#2d3748"></path><path d="M297.9546,106.2069q-11.3055,0-16.6932-3.3857t-5.3878-10.57a47.7847,47.7847,0,0,1,1.06-8.3613l5.9472-30.6778H265.9813l2.532-13.2486h16.8993l3.5918-18.7247h17.2527L302.6063,39.964h22.5521l-2.532,13.2486h-22.552l-6.1827,31.6788A20.2915,20.2915,0,0,0,293.48,88.13a3.9534,3.9534,0,0,0,1.9431,3.68q1.9433,1.1482,6.2416,1.1482h13.2486l-2.532,13.2486Z" transform="translate(-0.4961)" fill="#2d3748"></path><path d="M338.2138,107.62q-9.4224,0-14.6029-5.1228-5.1828-5.1228-5.1816-14.25,0-12.2469,9.3034-18.99t26.2617-6.7421h11.3643l.4711-2.8852a3.6427,3.6427,0,0,1,.1177-.7066v-1.001A5.6271,5.6271,0,0,0,362.974,52.8q-2.9748-1.7666-8.5086-1.7665a41.5275,41.5275,0,0,0-10.8933,1.59,85.9338,85.9338,0,0,0-13.3074,5.0639l2.7675-14.7206a74.3941,74.3941,0,0,1,24.6129-4.5929q12.07,0,18.6363,4.6518,6.5643,4.652,6.5655,13.72a36.323,36.323,0,0,1-.4711,5.5939q-.4716,3.003-1.1188,5.9471l-7.2425,37.626H358.47v-7.36A26.3115,26.3115,0,0,1,338.2138,107.62Zm7.1837-11.8354q6.476,0,11.2466-5.6822t6.3-15.3978h-6.6537q-19.9029,0-19.9023,12.13a8.3352,8.3352,0,0,0,9.009,8.95Z" transform="translate(-0.4961)" fill="#2d3748"></path><path d="M415.1828,107.62q-13.72,0-21.1683-7.4192t-7.4486-21.4333a42.63,42.63,0,0,1,5.005-20.8444,36.7663,36.7663,0,0,1,13.9257-14.338,40.3978,40.3978,0,0,1,20.7562-5.2111A39.0215,39.0215,0,0,1,445.8607,43.32l-3.1208,15.78a22.7112,22.7112,0,0,0-16.075-6.7126,21.2393,21.2393,0,0,0-11.8059,3.2974A22.52,22.52,0,0,0,406.88,64.783a29.416,29.416,0,0,0-2.8853,13.278q0,8.0083,3.4741,11.7765T417.95,93.606q8.8324,0,19.3724-6.1238l-3.2974,16.2516A45.998,45.998,0,0,1,415.1828,107.62Z" transform="translate(-0.4961)" fill="#2d3748"></path><path d="M458.1224,14.2911H475.375l-8.95,46.0463L490.2134,39.964H512L482.2643,64.5769l18.43,41.3356H482.382L469.31,75.058l-6.83,5.6527-4.8284,25.2018H440.3987Z" transform="translate(-0.4961)" fill="#2d3748"></path></svg></a><span class="flex items-center sm:hidden"><!----><svg height="20" class="text-gray-900 dark:text-white" viewBox="0 0 512 512"><!----><!----><rect x="10" y="10" width="492" height="90.4043" rx="17.383" stroke-width="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"></rect><rect x="10" y="411.5957" width="492" height="90.4043" rx="17.383" stroke-width="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"></rect><rect x="10" y="210.7979" width="492" height="90.4043" rx="17.383" stroke-width="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"></rect></svg></span></div><nav class="flex items-center flex-wrap sm:px-0 mt-2 sm:mt-0 hidden sm:flex"><a href="/documentation" class="w-full sm:w-auto border-b sm:border-0 border-gray-100 dark:border-gray-800 p-2 font-lg hover:text-pink-600 items-center flex font-light ">Documentation<!--#--></a><a href="/components" class="w-full sm:w-auto border-b sm:border-0 border-gray-100 dark:border-gray-800 p-2 font-lg hover:text-pink-600 items-center flex font-light ">Components<!--#--></a><a href="/contributors" class="w-full sm:w-auto border-b sm:border-0 border-gray-100 dark:border-gray-800 p-2 font-lg hover:text-pink-600 items-center flex font-light ">Contributors<!--#--></a><a href="/waifu" class="w-full sm:w-auto border-b sm:border-0 border-gray-100 dark:border-gray-800 p-2 font-lg hover:text-pink-600 items-center flex font-light ">Waifu<!--#--></a><a href="/pt-br" class="w-full sm:w-auto border-b sm:border-0 border-gray-100 dark:border-gray-800 p-2 font-lg hover:text-pink-600 items-center flex font-light sm:hidden">PortuguÃªs<!--#--></a><button class="w-full sm:w-auto border-b sm:border-0 border-gray-100 dark:border-gray-800 p-2 font-lg hover:text-pink-600 items-center flex font-light sm:hidden">Night Mode<!--#--></button></nav><div class="flex w-full sm:w-auto mt-4 sm:mt-0 sm:space-x-2 items-center hidden sm:flex"><a href="/pt-br" title="PortuguÃªs" class="hidden sm:flex"><svg height="20" viewBox="0 0 512 512"><!----><!----><circle cx="256" cy="256" r="246" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="20"></circle><path d="M437.0322,422.545c-37.8083-31.887-104.408-53.058-180.2668-53.058-76.4345,0-143.465,21.495-181.1186,53.7873" transform="translate(0 0)" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="20"></path><path d="M77.0141,87.2566c37.8977,31.6422,104.241,52.6167,179.7513,52.6167,74.9415,0,140.8449-20.663,178.8813-51.9068" transform="translate(0 0)" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="20"></path><ellipse cx="258.3311" cy="255.7857" rx="125.7359" ry="245.7857" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="20"></ellipse><line x1="10" y1="256" x2="502" y2="256" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="20"></line><line x1="258.3311" y1="10" x2="258.3311" y2="501.5714" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="20"></line></svg></a><button title="Night Mode" class="hidden sm:flex"><svg height="20" viewBox="0 0 512 512"><!----><!----><circle cx="256" cy="256" r="204.4813" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></circle><circle cx="256" cy="256" r="121.9955" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></circle><circle cx="256" cy="256" r="31.1621" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></circle><line x1="256" y1="256" x2="10" y2="256" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></line><line x1="502" y1="256" x2="256" y2="256" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></line><line x1="256" y1="256" x2="256" y2="10" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></line><line x1="256" y1="502" x2="256" y2="256" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></line></svg></button><a href="/getting-started" class="bg-pink-600 text-white px-4 py-2 border border-pink-600 hover:bg-transparent hover:text-pink-600 w-full sm:w-auto">Get Started<!--#--></a></div></div></header><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><section class="max-w-screen-xl mx-auto px-4 flex flex-wrap sm:flex-nowrap py-12 sm:py-24"><button class="fixed bottom-10 right-10 bg-pink-600 text-white shadow-xl rounded-full py-2 px-4 z-50 md:hidden ring-0"><svg height="15" viewBox="0 0 512 512"><!----><!----><path d="M33.98,393.2411a26.9768,26.9768,0,0,0,38.0683,0L255.89,209.3916,439.9435,393.4451a26.9816,26.9816,0,0,0,38.0643,0l16.12-16.1281a26.938,26.938,0,0,0,0-38.06L274.99,119.3309c-5.0641-5.0641-11.8121-8.6321-19.0842-8.6321h-.084c-7.2121,0-13.96,3.572-19.0241,8.6321L17.8641,338.6607A27.1824,27.1824,0,0,0,10,357.8848a26.9118,26.9118,0,0,0,7.8641,19.1282Z" transform="translate(0 0)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></path></svg></button><aside class="w-full md:w-80 fixed top-0 left-0 md:relative z-40 md:z-auto bg-white dark:bg-gray-900 h-screen md:h-auto p-4 overflow-y-auto md:p-0 md:pr-4 transform pb-24 sm:pb-0 translate-y-full md:translate-y-0"><div class="mb-3"><h5> <!--#-->Core concepts<!--#--> <!--#--></h5><nav><a href="/getting-started" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Getting started<!--#--> <!--#--></a><a href="/renderable-components" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Renderable components<!--#--> <!--#--></a><a href="/stateful-components" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Stateful components<!--#--> <!--#--></a><a href="/full-stack-lifecycle" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Full-stack lifecycle<!--#--> <!--#--></a><a href="/server-functions" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Server functions<!--#--> <!--#--></a><a href="/context" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Context<!--#--> <!--#--></a><a href="/routes-and-params" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Routes and params<!--#--> <!--#--></a><a href="/two-way-bindings" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Two-way bindings<!--#--> <!--#--></a></nav></div><div class="mb-3"><h5> <!--#-->Advanced concepts<!--#--> <!--#--></h5><nav><a href="/application-startup" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Application Startup<!--#--> <!--#--></a><a href="/context-data" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Context data<!--#--> <!--#--></a><a href="/context-instances" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Context instances<!--#--> <!--#--></a><a href="/context-environment" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Context environment<!--#--> <!--#--></a><a href="/context-page" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Context page<!--#--> <!--#--></a><a href="/context-project" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Context project<!--#--> <!--#--></a><a href="/context-settings" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Context settings<!--#--> <!--#--></a><a href="/context-secrets" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Context secrets<!--#--> <!--#--></a><a href="/instance-self" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Instance self<!--#--> <!--#--></a><a href="/server-request-and-response" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Server request and response<!--#--> <!--#--></a><a href="/styles" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Styles<!--#--> <!--#--></a><a href="/njs-file-extension" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->NJS file extension<!--#--> <!--#--></a><a href="/server-side-rendering" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Server-side rendering<!--#--> <!--#--></a><a href="/static-site-generation" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Static site generation<!--#--> <!--#--></a><a href="/service-worker" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->Service Worker<!--#--> <!--#--></a><a href="/how-to-deploy-a-nullstack-application" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->How to deploy<!--#--> <!--#--></a></nav></div><div class="mb-3"><h5> <!--#-->Examples<!--#--> <!--#--></h5><nav><a href="/how-to-use-mongodb-with-nullstack" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->How to use MongoDB<!--#--> <!--#--></a><a href="/how-to-use-google-analytics-with-nullstack" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->How to use Google Analytics<!--#--> <!--#--></a><a href="/how-to-use-facebook-pixel-with-nullstack" class="text-gray-500 dark:text-gray-300 hover:text-pink-600 block w-full"> <!--#-->How to use Facebook Pixel<!--#--> <!--#--></a></nav></div></aside><article class="w-full pb-24"><h1 class="text-pink-600 text-4xl font-light block mb-8"> <!--#-->Context Service Worker<!--#--> <!--#--></h1><div class="prose max-w-none"><ul>
<li>Type: <code>object</code></li>
<li>Origin: <a href="/context#----nullstack-context">Nullstack Context</a></li>
<li>Availability: server/client</li>
<li><strong>readwrite</strong> in <strong>server</strong> context</li>
<li><strong>readonly</strong> in <strong>client</strong> context</li>
</ul>
<p>It gives you granular control of your PWA behavior.</p>
<p><code>worker</code> keys will be used to generate the service worker file and should be set during the <a href="/application-startup">application startup</a>.</p>
<p><code>worker</code> keys are frozen after the <a href="/application-startup">application startup</a>.</p>
<p>The following keys are available in the object during the startup:</p>
<ul>
<li><strong>enabled</strong>: <code>boolean</code></li>
<li><strong>preload</strong>: <code>string array</code> (relative paths)</li>
<li><strong>headers</strong>: <code>object</code></li>
</ul>
<p>The <code>enabled</code> key defines if the service worker will be automatically registered by Nullstack.</p>
<p>By default <code>enabled</code> is set to <code>true</code> on production mode and <code>false</code> on development mode.</p>
<p><code>preload</code> is an array of paths that will be cached when the service worker is installed.</p>
<p>The assets required to start the application will be preloaded automatically, and you should configure only the extra pages you want to have available offline.</p>
<pre><code class="language-jsx"><span class="token keyword">import</span> Nullstack <span class="token keyword">from</span> <span class="token string">'nullstack'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>readdirSync<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token keyword">extends</span> <span class="token class-name">Nullstack</span> <span class="token punctuation">{</span>

  <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>worker<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> articles <span class="token operator">=</span> <span class="token function">readdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">,</span> <span class="token string">'articles'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    worker<span class="token punctuation">.</span>preload <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token operator">...</span>articles<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">article</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token string">'/'</span> <span class="token operator">+</span> article<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.md'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">'/nullstack.svg'</span><span class="token punctuation">,</span>
      <span class="token string">'/documentation'</span><span class="token punctuation">,</span>
      <span class="token string">'/components'</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// ...</span>

<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Application<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>ðŸ’¡ the example above is extracted from this repository and allows the documentation to be fully accessible offline.</p>
</blockquote>
<p>The following keys are available as <strong>readonly</strong> in the client context:</p>
<ul>
<li><strong>enabled</strong>: <code>boolean</code></li>
<li><strong>preload</strong>: <code>string array</code> (relative paths)</li>
<li><strong>online</strong>: <code>boolean</code></li>
<li><strong>fetching</strong>: <code>boolean</code></li>
<li><strong>responsive</strong>: <code>boolean</code></li>
<li><strong>installation</strong>: <code>BeforeInstallPromptEvent</code></li>
<li><strong>registration</strong>: <code>ServiceWorkerRegistration</code></li>
<li><strong>loading</strong>: <code>object</code></li>
</ul>
<p>The following keys are available as <strong>readwrite</strong> in the client context:</p>
<ul>
<li><strong>headers</strong>: <code>object</code></li>
</ul>
<p>The <code>responsive</code> key determines if the application has all the responses it needs to render the current page.</p>
<p>Nullstack will try to keep your application responsive as long as possible and set the key to <code>false</code> only when there are no ways of retrieving any response from the network or offline according to the fetch strategy for the <a href="/context-environment">environment</a>.</p>
<p>The <code>online</code> key will listen for network events and rerender the application when <code>navigator.onLine</code> value changes.</p>
<p>When the application is back online Nullstack will try to make the application responsive again and rerender if necessary.</p>
<pre><code class="language-jsx"><span class="token keyword">import</span> Nullstack <span class="token keyword">from</span> <span class="token string">'nullstack'</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token keyword">extends</span> <span class="token class-name">Nullstack</span> <span class="token punctuation">{</span>
 
  <span class="token comment">// ...</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>worker<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>worker<span class="token punctuation">.</span>responsive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">OfflineWarning</span></span> <span class="token punctuation">/></span></span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Home</span></span> <span class="token attr-name">route</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<p>You can access the current service worker <strong>registration</strong> and <strong>installation</strong> from the <code>worker</code> key to control the flow of your PWA.</p>
<p>The <code>registration</code> key refers to the service worker registration and will be only available once the registration process is complete.</p>
<p>The <code>installation</code> key refers to the deferred installation prompt event and will only be available if the <code>beforeinstallprompt</code> event is triggered.</p>
<pre><code class="language-jsx"><span class="token keyword">import</span> Nullstack <span class="token keyword">from</span> <span class="token string">'nullstack'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PWAInstaller</span> <span class="token keyword">extends</span> <span class="token class-name">Nullstack</span> <span class="token punctuation">{</span>

  installed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  hidden <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

  <span class="token keyword">async</span> <span class="token function">prompt</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>worker<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      worker<span class="token punctuation">.</span>installation<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span>outcome<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> worker<span class="token punctuation">.</span>installation<span class="token punctuation">.</span>userChoice<span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>outcome <span class="token operator">===</span> <span class="token string">'accepted'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'User accepted the A2HS prompt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'User dismissed the A2HS prompt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>hidden <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>worker<span class="token punctuation">,</span> project<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>hidden<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>worker<span class="token punctuation">.</span>installation<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>project<span class="token punctuation">.</span>favicon<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span> Do you want to add <span class="token punctuation">{</span>project<span class="token punctuation">.</span>name<span class="token punctuation">}</span> to your home screen<span class="token operator">?</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>prompt<span class="token punctuation">}</span></span><span class="token punctuation">></span></span> Install <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>hidden<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span> Not Now <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> PWAInstaller<span class="token punctuation">;</span>
</code></pre>
<h2 id="loading-screens"><a href="#loading-screens">Loading Screens</a></h2><p>When a <a href="/server-functions">server function</a> is called <code>fetching</code> will be set to <code>true</code> until the response is resolved.</p>
<p>When a <a href="/server-functions">server function</a> is called a key with the name of the <a href="/server-functions">server function</a> invoked will be set to <code>true</code> in the <code>loading</code> key until the response is resolved.</p>
<p>Any key you invoke on the <code>loading</code> object will always return a boolean instead of <code>undefined</code> for consistency.</p>
<p>When the server is emulating the client context for <a href="/server-side-rendering">server-side rendering</a>, every key of the <code>loading</code> object will always return <code>false</code>, saving multiple render cycles in performance.</p>
<pre><code class="language-jsx"><span class="token keyword">import</span> Nullstack <span class="token keyword">from</span> <span class="token string">'nullstack'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Page</span> <span class="token keyword">extends</span> <span class="token class-name">Nullstack</span> <span class="token punctuation">{</span>

  <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>worker<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onsubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>save<span class="token punctuation">}</span></span><span class="token punctuation">></span></span> 
        <span class="token punctuation">{</span>worker<span class="token punctuation">.</span>fetching <span class="token operator">&amp;&amp;</span> 
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span> loading<span class="token operator">...</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
        <span class="token punctuation">}</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">disabled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>worker<span class="token punctuation">.</span>loading<span class="token punctuation">.</span>save<span class="token punctuation">}</span></span><span class="token punctuation">></span></span> 
          Save
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Page<span class="token punctuation">;</span>
</code></pre>
<h2 id="custom-headers"><a href="#custom-headers">Custom headers</a></h2><p>You can use the <code>headers</code> key to configure the headers that the worker will use when fetching a server function.</p>
<blockquote>
<p>ðŸ”¥ Headers will be ignored when a server function is called during the <a href="/server-side-rendering">server-side rendering</a> process.</p>
</blockquote>
<pre><code class="language-jsx"><span class="token keyword">import</span> Nullstack <span class="token keyword">from</span> <span class="token string">'nullstack'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LoginPage</span> <span class="token keyword">extends</span> <span class="token class-name">Nullstack</span> <span class="token punctuation">{</span>

  <span class="token comment">// ...</span>

  <span class="token keyword">async</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>worker<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Authorization'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token function">authorize</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>request<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> authorization <span class="token operator">=</span> request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Authorization'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// ...</span>

<span class="token punctuation">}</span>


<span class="token keyword">export</span> <span class="token keyword">default</span> LoginPage<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>âœ¨ Learn more about the <a href="/server-request-and-response">server request and response</a></p>
</blockquote>
<h2 id="server-side-render-strategy"><a href="#server-side-render-strategy">Server-side render strategy</a></h2><ul>
<li>Requests for different origins will be fetched normally;</li>
<li>Requests that are not GET will be fetched normally;</li>
<li>Fingerprinted assets will be loaded into cache at installation time;</li>
<li>Fingerprinted assets will be loaded from cache first then fallback to the network if needed;</li>
<li>Paths with an extension will be retrieved stale and update the cache in the background for subsequent request;</li>
<li>Navigation paths will be loaded from the network then fallback to a page in which <code>worker.responsive</code> and <code>worker.online</code> are set to <code>false</code>;</li>
</ul>
<h2 id="static-site-generation-strategy"><a href="#static-site-generation-strategy">Static-site generation strategy</a></h2><ul>
<li>Requests for different origins will be fetched normally;</li>
<li>Requests that are not GET will be fetched normally;</li>
<li>Fingerprinted assets will be loaded into cache at installation time;</li>
<li>Fingerprinted assets will be loaded from cache first then fallback to the network if needed;</li>
<li>Paths with an extension will be retrieved stale and update the cache in the background for subsequent request;</li>
<li>The home page will be loaded network first and then fallback to a cached copy if needed;</li>
<li>Navigation paths will instead load only the static API data and merge it with the application template to generate a response.</li>
<li>Navigating to a static route will cache only the data of that page;</li>
<li>When data is not available in the cache or network it will fallback to a page in which <code>worker.responsive</code> and <code>worker.online</code> are set to <code>false</code>;</li>
</ul>
<h2 id="custom-strategy"><a href="#custom-strategy">Custom Strategy</a></h2><p>Nullstack will install automatically your service worker if <code>enabled</code> is set to <code>true</code> with the following events:</p>
<ul>
<li><code>install</code></li>
<li><code>activate</code></li>
<li><code>fetch</code></li>
</ul>
<p>You can override any of those events by creating a <strong>service-worker.js</strong> in the public folder;</p>
<p>If any of the keywords above are found Nullstack will inject your function in the service worker code instead of the default.</p>
<p>For convenience a <code>context</code> key is injected in the service worker <code>self</code> with the following keys:</p>
<ul>
<li><code>worker</code></li>
<li><a href="/context-project"><code>project</code></a></li>
<li><a href="/context-environment"><code>environment</code></a></li>
</ul>
<pre><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cacheNames <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> cachesToDelete <span class="token operator">=</span> cacheNames<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">cacheName</span> <span class="token operator">=></span> cacheName <span class="token operator">!==</span> self<span class="token punctuation">.</span>context<span class="token punctuation">.</span>environment<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>cachesToDelete<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cacheName</span><span class="token punctuation">)</span> <span class="token operator">=></span> caches<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>cacheName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>registration<span class="token punctuation">.</span>navigationPreload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> self<span class="token punctuation">.</span>registration<span class="token punctuation">.</span>navigationPreload<span class="token punctuation">.</span><span class="token function">enable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    self<span class="token punctuation">.</span>clients<span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> activate<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>ðŸ’¡ The example above is extracted from the generated service worker and uses <code>self.context.environment.key</code></p>
</blockquote>
<h2 id="next-step"><a href="#next-step">Next step</a></h2><p>âš” Learn <a href="/how-to-deploy-a-nullstack-application">how to deploy a Nullstack application</a>.</p>
</div></article></section><!-- --><!-- --><!----><footer class="flex flex-wrap w-full justify-center relative"><div class="w-full relative flex justify-center h-80 bg-70 hover:bg-100 bg-center bg-no-repeat" style="background-image: url(/stars.webp); transition: background-size 3s;"><img src="/footer.webp" alt="Nulla-Chan" class="absolute bottom-0"/></div><div class="bg-gray-800 w-full py-4 flex-wrap"><nav class="w-full flex items-center justify-center space-x-1"><a href="https://twitter.com/nullstackapp" title="Twitter" target="_blank" rel="noopener" class="hover:text-pink-600 text-white py-2 px-4 inline-block"><svg height="30" viewBox="0 0 512 512"><!----><!----><polygon points="78.808 70.998 436.256 70.998 455.66 128.19 56.34 128.19 78.808 70.998" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></polygon><path d="M92.0848,128.19l26.5533,342.1048s-.4218,31.6831,29.4062,31.6831H359.0261s31.272,1.9956,34.3358-31.6831S419.9152,128.19,419.9152,128.19" transform="translate(0 0)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></path><line x1="178.9311" y1="455.8086" x2="165.2112" y2="179.2536" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></line><line x1="255.7864" y1="455.8086" x2="255.7864" y2="179.2536" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></line><line x1="330.6073" y1="455.8086" x2="345.3995" y2="179.2536" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></line><path d="M195.9039,70.9981V27.0832S193.8613,10,212.987,10h86.53s16.6423,2.7853,16.6423,19.1257V70.9981" transform="translate(0 0)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></path></svg></a><a href="https://github.com/nullstack/nullstack" title="Github" target="_blank" rel="noopener" class="hover:text-pink-600 text-white py-2 px-4 inline-block"><svg height="30" viewBox="0 0 512 512"><!----><!----><path d="M474.9313,37.0637Q447.87,10.0024,409.7608,10H102.2441Q64.1474,10,37.0686,37.0637,10,64.1327,10,102.2391V409.7558q0,38.1265,27.0686,65.1754Q64.1376,502,102.2441,502H174a88.3383,88.3383,0,0,0,10.5759-.4621c2.3443-.3243,4.6885-1.7249,7.0475-4.1821q3.5162-3.6858,3.5138-10.7331,0-.9511-.1524-21.7711-.1768-20.8174-.177-33l-7.3717,1.2876a96.0562,96.0562,0,0,1-17.7754,1.1155,136.5041,136.5041,0,0,1-22.2477-2.2459,49.8777,49.8777,0,0,1-21.4614-9.5979,40.6083,40.6083,0,0,1-14.09-19.6971l-3.2092-7.3717a78.7987,78.7987,0,0,0-10.0942-16.3357q-6.8852-8.9862-13.9177-12.173L82.39,365.2212a23.235,23.235,0,0,1-4.1624-3.8383,17.3845,17.3845,0,0,1-2.88-4.4918c-.6538-1.499-.1179-2.7274,1.5922-3.6858,1.71-.9632,4.8015-1.44,9.2933-1.44l6.4084.9583c4.2657.8649,9.5439,3.4156,15.8588,7.6961a51.6678,51.6678,0,0,1,15.53,16.645q7.3714,13.1294,17.7755,20.0215,10.3941,6.8853,20.9846,6.8951a91.5063,91.5063,0,0,0,18.2573-1.5973,63.2336,63.2336,0,0,0,14.4142-4.816q2.8822-21.4517,15.6868-32.9809a218.4024,218.4024,0,0,1-32.8285-5.7794,129.481,129.481,0,0,1-30.101-12.4974A86.2073,86.2073,0,0,1,122.418,324.849q-10.2542-12.8121-16.8172-33.6346-6.5683-20.8175-6.5657-48.0485,0-38.76,25.324-65.9813-11.8681-29.14,2.2263-65.3476,9.2956-2.8751,27.5454,4.32,18.26,7.2312,26.7592,12.345,8.5,5.1232,13.6131,8.64a231.5649,231.5649,0,0,1,122.9939,0L329.67,129.46a171.64,171.64,0,0,1,29.4867-14.09q16.962-6.4208,25.9334-3.5335,14.4264,36.195,2.5556,65.3476,25.307,27.2382,25.3193,65.9813,0,27.2382-6.5657,48.2207-6.5608,20.9649-16.97,33.6343a89.5585,89.5585,0,0,1-25.9532,21.29,129.6562,129.6562,0,0,1-30.1009,12.4974,219.14,219.14,0,0,1-32.8482,5.7794q16.6452,14.3967,16.6648,45.4783v76.5573a20.5385,20.5385,0,0,0,1.5923,8.8116,8.8587,8.8587,0,0,0,5.1258,4.6442,28.4388,28.4388,0,0,0,6.2561,1.5921A71.8287,71.8287,0,0,0,338,502h71.7608q38.1262,0,65.1705-27.0689Q502,447.8627,502,409.7363V102.2391q0-38.0968-27.0687-65.1754Zm0,0" transform="translate(0 0.0001)" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="20"></path></svg></a><a href="https://www.youtube.com/nullstack" title="Youtube" target="_blank" rel="noopener" class="hover:text-pink-600 text-white py-2 px-4 inline-block"><svg height="30" viewBox="0 0 512 512"><!----><!----><path d="M427.7752,84.2558H84.2248A74.2249,74.2249,0,0,0,10,158.4807V353.5193a74.2249,74.2249,0,0,0,74.2248,74.2249h343.55A74.2249,74.2249,0,0,0,502,353.5193V158.4807A74.2249,74.2249,0,0,0,427.7752,84.2558Zm-84.406,180.2761L219.2732,341.2a10.0258,10.0258,0,0,1-15.2967-8.53V177.1147c2.4387-7.5231,10.0177-9.5745,15.2967-6.314l124.096,76.6719a10.0242,10.0242,0,0,1,0,17.0593Z" transform="translate(0 0)" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="20"></path></svg></a></nav><nav class="w-full flex items-center justify-center space-x-1"><a href="https://github.com/nullstack/nullstack/stargazers" class="text-white flex flex-wrap text-xl text-center mt-3" target="_blank" rel="noopener"><span class="block w-full">leave an star on <!--#--></span><span class="font-bold block w-full">GitHub<!--#--></span></a></nav></div></footer></div></main></div>
    <script async>
      window.page = {"image":"/image-1200x630.png","status":200,"title":"Context Service Worker - Nullstack","description":"The worker object is a proxy in the Nullstack Context available in both client and server and gives you granular control of your PWA behavior"};
      window.instances = {"application":{},"n-0-0-0-0":{"expanded":false,"locale":"en-US","i18n":{"home":{"title":"Nullstack","href":"/"},"links":[{"title":"Documentation","href":"/documentation"},{"title":"Components","href":"/components"},{"title":"Contributors","href":"/contributors"},{"title":"Waifu","href":"/waifu"}],"action":{"title":"Get Started","href":"/getting-started"},"language":{"title":"PortuguÃªs","href":"/pt-br"},"mode":{"dark":"Night Mode","light":"Day Mode"}}},"n-0-0-0-0-0-0-0-1-1":{},"n-0-0-0-0-0-0-2-0-0":{},"n-0-0-0-0-0-0-2-1-0":{},"n-0-0-0-12":{"title":"Context Service Worker","html":"<ul>\n<li>Type: <code>object</code></li>\n<li>Origin: <a href=\"/context#----nullstack-context\">Nullstack Context</a></li>\n<li>Availability: server/client</li>\n<li><strong>readwrite</strong> in <strong>server</strong> context</li>\n<li><strong>readonly</strong> in <strong>client</strong> context</li>\n</ul>\n<p>It gives you granular control of your PWA behavior.</p>\n<p><code>worker</code> keys will be used to generate the service worker file and should be set during the <a href=\"/application-startup\">application startup</a>.</p>\n<p><code>worker</code> keys are frozen after the <a href=\"/application-startup\">application startup</a>.</p>\n<p>The following keys are available in the object during the startup:</p>\n<ul>\n<li><strong>enabled</strong>: <code>boolean</code></li>\n<li><strong>preload</strong>: <code>string array</code> (relative paths)</li>\n<li><strong>headers</strong>: <code>object</code></li>\n</ul>\n<p>The <code>enabled</code> key defines if the service worker will be automatically registered by Nullstack.</p>\n<p>By default <code>enabled</code> is set to <code>true</code> on production mode and <code>false</code> on development mode.</p>\n<p><code>preload</code> is an array of paths that will be cached when the service worker is installed.</p>\n<p>The assets required to start the application will be preloaded automatically, and you should configure only the extra pages you want to have available offline.</p>\n<pre><code class=\"language-jsx\"><span class=\"token keyword\">import</span> Nullstack <span class=\"token keyword\">from</span> <span class=\"token string\">'nullstack'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> path <span class=\"token keyword\">from</span> <span class=\"token string\">'path'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>readdirSync<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'fs'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Application</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Nullstack</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>worker<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> articles <span class=\"token operator\">=</span> <span class=\"token function\">readdirSync</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'..'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'articles'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    worker<span class=\"token punctuation\">.</span>preload <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token operator\">...</span>articles<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">article</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">'/'</span> <span class=\"token operator\">+</span> article<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.md'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'/nullstack.svg'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'/documentation'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token string\">'/components'</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token comment\">// ...</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Application<span class=\"token punctuation\">;</span>\n</code></pre>\n<blockquote>\n<p>ðŸ’¡ the example above is extracted from this repository and allows the documentation to be fully accessible offline.</p>\n</blockquote>\n<p>The following keys are available as <strong>readonly</strong> in the client context:</p>\n<ul>\n<li><strong>enabled</strong>: <code>boolean</code></li>\n<li><strong>preload</strong>: <code>string array</code> (relative paths)</li>\n<li><strong>online</strong>: <code>boolean</code></li>\n<li><strong>fetching</strong>: <code>boolean</code></li>\n<li><strong>responsive</strong>: <code>boolean</code></li>\n<li><strong>installation</strong>: <code>BeforeInstallPromptEvent</code></li>\n<li><strong>registration</strong>: <code>ServiceWorkerRegistration</code></li>\n<li><strong>loading</strong>: <code>object</code></li>\n</ul>\n<p>The following keys are available as <strong>readwrite</strong> in the client context:</p>\n<ul>\n<li><strong>headers</strong>: <code>object</code></li>\n</ul>\n<p>The <code>responsive</code> key determines if the application has all the responses it needs to render the current page.</p>\n<p>Nullstack will try to keep your application responsive as long as possible and set the key to <code>false</code> only when there are no ways of retrieving any response from the network or offline according to the fetch strategy for the <a href=\"/context-environment\">environment</a>.</p>\n<p>The <code>online</code> key will listen for network events and rerender the application when <code>navigator.onLine</code> value changes.</p>\n<p>When the application is back online Nullstack will try to make the application responsive again and rerender if necessary.</p>\n<pre><code class=\"language-jsx\"><span class=\"token keyword\">import</span> Nullstack <span class=\"token keyword\">from</span> <span class=\"token string\">'nullstack'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Application</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Nullstack</span> <span class=\"token punctuation\">{</span>\n \n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>worker<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>worker<span class=\"token punctuation\">.</span>responsive<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">OfflineWarning</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>main</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Home</span></span> <span class=\"token attr-name\">route</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>main</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n</code></pre>\n<p>You can access the current service worker <strong>registration</strong> and <strong>installation</strong> from the <code>worker</code> key to control the flow of your PWA.</p>\n<p>The <code>registration</code> key refers to the service worker registration and will be only available once the registration process is complete.</p>\n<p>The <code>installation</code> key refers to the deferred installation prompt event and will only be available if the <code>beforeinstallprompt</code> event is triggered.</p>\n<pre><code class=\"language-jsx\"><span class=\"token keyword\">import</span> Nullstack <span class=\"token keyword\">from</span> <span class=\"token string\">'nullstack'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">PWAInstaller</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Nullstack</span> <span class=\"token punctuation\">{</span>\n\n  installed <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  hidden <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>worker<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n      worker<span class=\"token punctuation\">.</span>installation<span class=\"token punctuation\">.</span><span class=\"token function\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>outcome<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> worker<span class=\"token punctuation\">.</span>installation<span class=\"token punctuation\">.</span>userChoice<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>outcome <span class=\"token operator\">===</span> <span class=\"token string\">'accepted'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'User accepted the A2HS prompt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'User dismissed the A2HS prompt'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">finally</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>hidden <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>worker<span class=\"token punctuation\">,</span> project<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>hidden<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>worker<span class=\"token punctuation\">.</span>installation<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>project<span class=\"token punctuation\">.</span>favicon<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span> Do you want to add <span class=\"token punctuation\">{</span>project<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span> to your home screen<span class=\"token operator\">?</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onclick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>prompt<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span> Install <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onclick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>hidden<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span> Not Now <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> PWAInstaller<span class=\"token punctuation\">;</span>\n</code></pre>\n<h2 id=\"loading-screens\"><a href=\"#loading-screens\">Loading Screens</a></h2><p>When a <a href=\"/server-functions\">server function</a> is called <code>fetching</code> will be set to <code>true</code> until the response is resolved.</p>\n<p>When a <a href=\"/server-functions\">server function</a> is called a key with the name of the <a href=\"/server-functions\">server function</a> invoked will be set to <code>true</code> in the <code>loading</code> key until the response is resolved.</p>\n<p>Any key you invoke on the <code>loading</code> object will always return a boolean instead of <code>undefined</code> for consistency.</p>\n<p>When the server is emulating the client context for <a href=\"/server-side-rendering\">server-side rendering</a>, every key of the <code>loading</code> object will always return <code>false</code>, saving multiple render cycles in performance.</p>\n<pre><code class=\"language-jsx\"><span class=\"token keyword\">import</span> Nullstack <span class=\"token keyword\">from</span> <span class=\"token string\">'nullstack'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Page</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Nullstack</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n \n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>worker<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onsubmit</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span> \n        <span class=\"token punctuation\">{</span>worker<span class=\"token punctuation\">.</span>fetching <span class=\"token operator\">&amp;&amp;</span> \n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">></span></span> loading<span class=\"token operator\">...</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">disabled</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>worker<span class=\"token punctuation\">.</span>loading<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span> \n          Save\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Page<span class=\"token punctuation\">;</span>\n</code></pre>\n<h2 id=\"custom-headers\"><a href=\"#custom-headers\">Custom headers</a></h2><p>You can use the <code>headers</code> key to configure the headers that the worker will use when fetching a server function.</p>\n<blockquote>\n<p>ðŸ”¥ Headers will be ignored when a server function is called during the <a href=\"/server-side-rendering\">server-side rendering</a> process.</p>\n</blockquote>\n<pre><code class=\"language-jsx\"><span class=\"token keyword\">import</span> Nullstack <span class=\"token keyword\">from</span> <span class=\"token string\">'nullstack'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">LoginPage</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Nullstack</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token keyword\">async</span> <span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>worker<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Authorization'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Bearer </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>token<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token function\">authorize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>request<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> authorization <span class=\"token operator\">=</span> request<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">[</span><span class=\"token string\">'Authorization'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token comment\">// ...</span>\n\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> LoginPage<span class=\"token punctuation\">;</span>\n</code></pre>\n<blockquote>\n<p>âœ¨ Learn more about the <a href=\"/server-request-and-response\">server request and response</a></p>\n</blockquote>\n<h2 id=\"server-side-render-strategy\"><a href=\"#server-side-render-strategy\">Server-side render strategy</a></h2><ul>\n<li>Requests for different origins will be fetched normally;</li>\n<li>Requests that are not GET will be fetched normally;</li>\n<li>Fingerprinted assets will be loaded into cache at installation time;</li>\n<li>Fingerprinted assets will be loaded from cache first then fallback to the network if needed;</li>\n<li>Paths with an extension will be retrieved stale and update the cache in the background for subsequent request;</li>\n<li>Navigation paths will be loaded from the network then fallback to a page in which <code>worker.responsive</code> and <code>worker.online</code> are set to <code>false</code>;</li>\n</ul>\n<h2 id=\"static-site-generation-strategy\"><a href=\"#static-site-generation-strategy\">Static-site generation strategy</a></h2><ul>\n<li>Requests for different origins will be fetched normally;</li>\n<li>Requests that are not GET will be fetched normally;</li>\n<li>Fingerprinted assets will be loaded into cache at installation time;</li>\n<li>Fingerprinted assets will be loaded from cache first then fallback to the network if needed;</li>\n<li>Paths with an extension will be retrieved stale and update the cache in the background for subsequent request;</li>\n<li>The home page will be loaded network first and then fallback to a cached copy if needed;</li>\n<li>Navigation paths will instead load only the static API data and merge it with the application template to generate a response.</li>\n<li>Navigating to a static route will cache only the data of that page;</li>\n<li>When data is not available in the cache or network it will fallback to a page in which <code>worker.responsive</code> and <code>worker.online</code> are set to <code>false</code>;</li>\n</ul>\n<h2 id=\"custom-strategy\"><a href=\"#custom-strategy\">Custom Strategy</a></h2><p>Nullstack will install automatically your service worker if <code>enabled</code> is set to <code>true</code> with the following events:</p>\n<ul>\n<li><code>install</code></li>\n<li><code>activate</code></li>\n<li><code>fetch</code></li>\n</ul>\n<p>You can override any of those events by creating a <strong>service-worker.js</strong> in the public folder;</p>\n<p>If any of the keywords above are found Nullstack will inject your function in the service worker code instead of the default.</p>\n<p>For convenience a <code>context</code> key is injected in the service worker <code>self</code> with the following keys:</p>\n<ul>\n<li><code>worker</code></li>\n<li><a href=\"/context-project\"><code>project</code></a></li>\n<li><a href=\"/context-environment\"><code>environment</code></a></li>\n</ul>\n<pre><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">activate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> cacheNames <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> cachesToDelete <span class=\"token operator\">=</span> cacheNames<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cacheName</span> <span class=\"token operator\">=></span> cacheName <span class=\"token operator\">!==</span> self<span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>environment<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">all</span><span class=\"token punctuation\">(</span>cachesToDelete<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">cacheName</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> caches<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>cacheName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>registration<span class=\"token punctuation\">.</span>navigationPreload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> self<span class=\"token punctuation\">.</span>registration<span class=\"token punctuation\">.</span>navigationPreload<span class=\"token punctuation\">.</span><span class=\"token function\">enable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    self<span class=\"token punctuation\">.</span>clients<span class=\"token punctuation\">.</span><span class=\"token function\">claim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nself<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'activate'</span><span class=\"token punctuation\">,</span> activate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<blockquote>\n<p>ðŸ’¡ The example above is extracted from the generated service worker and uses <code>self.context.environment.key</code></p>\n</blockquote>\n<h2 id=\"next-step\"><a href=\"#next-step\">Next step</a></h2><p>âš” Learn <a href=\"/how-to-deploy-a-nullstack-application\">how to deploy a Nullstack application</a>.</p>\n","description":"The worker object is a proxy in the Nullstack Context available in both client and server and gives you granular control of your PWA behavior","topics":[{"title":"Core concepts","description":"Start your journey in Nullstack with these basic concepts","links":[{"title":"Getting started","href":"/getting-started"},{"title":"Renderable components","href":"/renderable-components"},{"title":"Stateful components","href":"/stateful-components"},{"title":"Full-stack lifecycle","href":"/full-stack-lifecycle"},{"title":"Server functions","href":"/server-functions"},{"title":"Context","href":"/context"},{"title":"Routes and params","href":"/routes-and-params"},{"title":"Two-way bindings","href":"/two-way-bindings"}]},{"title":"Advanced concepts","description":"These are concepts that you will most likely learn as you need in your projects","links":[{"title":"Application Startup","href":"/application-startup"},{"title":"Context data","href":"/context-data"},{"title":"Context instances","href":"/context-instances"},{"title":"Context environment","href":"/context-environment"},{"title":"Context page","href":"/context-page"},{"title":"Context project","href":"/context-project"},{"title":"Context settings","href":"/context-settings"},{"title":"Context secrets","href":"/context-secrets"},{"title":"Instance self","href":"/instance-self"},{"title":"Server request and response","href":"/server-request-and-response"},{"title":"Styles","href":"/styles"},{"title":"NJS file extension","href":"/njs-file-extension"},{"title":"Server-side rendering","href":"/server-side-rendering"},{"title":"Static site generation","href":"/static-site-generation"},{"title":"Service Worker","href":"/service-worker"},{"title":"How to deploy","href":"/how-to-deploy-a-nullstack-application"}]},{"title":"Examples","description":"The best way to learn Nullstack is by reading some code","links":[{"title":"How to use MongoDB","href":"/how-to-use-mongodb-with-nullstack"},{"title":"How to use Google Analytics","href":"/how-to-use-google-analytics-with-nullstack"},{"title":"How to use Facebook Pixel","href":"/how-to-use-facebook-pixel-with-nullstack"}]}]},"n-0-0-0-12-0-0-0":{},"n-0-0-0-13":{},"n-0-0-0-15":{},"n-0-0-0-16":{"locale":"en-US","i18n":{"links":[{"title":"YouTube","href":"https://www.youtube.com/channel/UCUNPaxoppH3lu6JTrUX78Ww"},{"title":"Twitter","href":"https://twitter.com/nullstackapp"},{"title":"GitHub","href":"https://github.com/nullstack"}],"star":"leave an star on "}},"n-0-0-0-16-0-1-0-0-0-0":{},"n-0-0-0-16-0-1-0-1-0-0":{},"n-0-0-0-16-0-1-0-2-0-0":{}};
      window.environment = {"client":false,"server":true,"development":false,"production":true,"static":true,"key":"18812b1cb40cd21fad1f9d310e5064f10dac9d64"};
      window.settings = {};
      window.worker = {"enabled":true,"fetching":false,"preload":["/404","/application-startup","/context-data","/context-environment","/context-instances","/context-page","/context-project","/context-secrets","/context-settings","/context","/full-stack-lifecycle","/getting-started","/how-to-deploy-a-nullstack-application","/how-to-use-facebook-pixel-with-nullstack","/how-to-use-google-analytics-with-nullstack","/how-to-use-mongodb-with-nullstack","/instance-self","/njs-file-extension","/renderable-components","/routes-and-params","/server-functions","/server-request-and-response","/server-side-rendering","/service-worker","/stateful-components","/static-site-generation","/styles","/two-way-bindings","/illustrations/nulla-dps.webp","/illustrations/nulla-glue.webp","/illustrations/nulla-healer.webp","/illustrations/nulla-hero.webp","/illustrations/nulla-map.webp","/illustrations/nulla-scrolls.webp","/illustrations/nulla-tanker.webp","/illustrations/nulla-tools.webp","/arrow.webp","/stars.webp","/footer.webp","/documentation","/components","/contributors","/roboto-v20-latin-300.woff2","/roboto-v20-latin-500.woff2","/crete-round-v9-latin-regular.woff2"],"headers":{},"queues":{},"online":true,"responsive":true};
      window.params = {"slug":"service-worker"};
      window.project = {"cdn":"","protocol":"https","domain":"nullstack.app","name":"Nullstack","color":"#d22365","type":"website","display":"standalone","orientation":"portrait","scope":"/","root":"/","sitemap":true,"favicon":"/favicon-96x96.png","disallow":[],"icons":{"72":"/icon-72x72.png","96":"/icon-96x96.png","128":"/icon-128x128.png","144":"/icon-144x144.png","152":"/icon-152x152.png","180":"/icon-180x180.png","192":"/icon-192x192.png","384":"/icon-384x384.png","512":"/icon-512x512.png"},"backgroundColor":"#2d3748"};
      window.context = {"mode":"light","oppositeMode":"dark"};
      document.addEventListener('DOMContentLoaded', () => {
        const script = window.document.createElement('script');
        script.src = '/client-18812b1cb40cd21fad1f9d310e5064f10dac9d64.js';
        script.integrity = 'sha512-m/lKqAgJAD4VOaNMDVPkuzLgKfdxonY4WypML0UAlxH0xhckfzxAHbE/u4G85yO9Xly+lYkVUsVuA55D3drCxA==';
        script.crossOrigin = 'anonymous';
        document.body.append(script);
      });
    </script>
  </body>
</html>